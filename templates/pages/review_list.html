{% extends "_base.html" %}

{% block title %}Reviews{% endblock %}
{% block header %}Reviews{% endblock %}

{% block main %}
  {% if user.is_authenticated %}
    <a class="btn btn-success btn-sm float-end" href="{% url 'pages:review-create' %}">
      + New Review
    </a>
  {% endif %}

  <h2>Reviews</h2>

  <ul class="list-group list-group-flush mb-3">
    {% for review in review_list %}
      <li class="list-group-item d-flex justify-content-between align-items-center">
        <a href="{% url 'pages:review-detail' review.slug %}">{{ review.title }}</a>

        {% if user.is_authenticated and user.is_staff or review.user_id == user.id %}
          <span class="ms-2">
            <a class="btn btn-info btn-sm me-2" href="{% url 'pages:review-update' review.slug %}">Update</a>
            <a class="btn btn-danger btn-sm" href="{% url 'pages:review-delete' review.slug %}">Delete</a>
          </span>
        {% else %}
          <small class="text-muted">by {{ review.user.username }}</small>
        {% endif %}
      </li>
    {% empty %}
      <li class="list-group-item">No reviews yet.</li>
    {% endfor %}
  </ul>
{% endblock %}

